<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2A3950;
            --secondary-color: #4A90E2;
            --accent-color: #FF6B6B;
            --background-color: #F8F9FA;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            padding: 20px;
            background: var(--background-color);
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header-info {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .customer-input-container {
            position: relative;
            max-width: 500px;
            margin: 30px auto;
        }

        #customerName {
            width: 100%;
            padding: 18px 25px 18px 55px;
            border: 2px solid var(--secondary-color);
            border-radius: 35px;
            font-size: 18px;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.95);
        }

        #customerName:focus {
            border-color: var(--primary-color);
            box-shadow: 0 5px 20px rgba(42,57,80,0.1);
        }

        .customer-icon {
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 24px;
        }

        #gradeSelect {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            font-size: 18px;
        }

        .books-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .books-table th, 
        .books-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #eee;
        }

        .books-table th {
            background: var(--primary-color);
            color: white;
        }

        .book-item input {
            width: 20px;
            height: 20px;
        }

        #selectedBooks {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }

        .price-section {
            display: grid;
            gap: 15px;
            max-width: 500px;
            margin: 20px auto;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }

        #saveButton {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            display: block;
            margin: 20px auto;
        }

        .invoice-style {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 45px rgba(0,0,0,0.12);
            position: relative;
            overflow: hidden;
        }

        .invoice-style::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: var(--secondary-color);
            opacity: 0.1;
            border-radius: 50%;
            transform: translate(50%, -50%);
        }

        .invoice-header {
            text-align: center;
            margin-bottom: 35px;
            position: relative;
        }

        .invoice-header h1 {
            color: var(--primary-color);
            font-size: 32px;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .invoice-header p {
            color: #666;
            font-size: 18px;
            margin-bottom: 25px;
        }

        .invoice-divider {
            width: 60%;
            height: 2px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            margin: 25px auto;
            opacity: 0.3;
        }

        .invoice-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 20px;
            margin: 8px 0;
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .invoice-row:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .invoice-total {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 18px;
        }

        .invoice-footer {
            text-align: center;
            margin-top: 35px;
            padding-top: 25px;
            color: var(--accent-color);
            font-size: 16px;
            border-top: 1px dashed #ddd;
        }
		        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ÙƒØªØ¨ Ø§Ù„Ø´Ø¨ÙƒÙŠØ© */
        .books-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .book-card {
            border: 2px solid #eee;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            background: white;
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .book-card label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }

        .book-card input {
            width: 20px;
            height: 20px;
        }
		
    </style>
</head>
<body>


    <div class="container">
        <div class="header-info">
            <h1 class="library-name">Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµØ§Ø¯Ù‚</h1>
            <p class="library-address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§Ù„Ù†Ù‡Ø±ÙˆØ§Ù† - Ø´Ø§Ø±Ø¹ 60- Ù…Ù‚Ø§Ø¨Ù„ Ù…ÙƒØªØ¨ Ø±ÙŠØ§Ø¶ ØºØ§Ù„ÙŠ</p>
        </div>

    <div class="customer-input-container">
        <i class="fas fa-user customer-icon"></i>
        <input type="text" id="customerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ† Ø§Ù„ÙƒØ±ÙŠÙ…">
    </div>
	
        <select id="gradeSelect" onchange="loadBooks()">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
            <option value="grade1">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
            <option value="grade2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
            <option value="grade3">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
            <option value="grade4">Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
            <option value="grade5">Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
            <option value="grade6">Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
        </select>

    <div class="books-grid" id="booksContainer"></div>
            <thead>
                <tr>
                    <th>Ø§Ø®ØªÙŠØ§Ø±</th>
                    <th>Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨</th>
                    <th>Ø§Ù„Ø³Ø¹Ø±</th>
                </tr>
            </thead>
            <tbody id="booksContainer"></tbody>
        </table>

        <div id="selectedBooks">
            <h3>Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</h3>
            <div id="selectedList"></div>
        </div>

        <div class="price-section">
            <div class="price-row">
                <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</span>
                <input type="text" id="total" readonly>
            </div>
            <div class="price-row">
                <span>Ø§Ù„Ø®ØµÙ…:</span>
                <input type="number" id="discount" value="0">
            </div>
            <div class="price-row">
                <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</span>
                <input type="text" id="finalAmount" readonly>
            </div>
        </div>

        <button id="saveButton">ğŸ–¨ï¸ Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙƒØµÙˆØ±Ø©</button>
    </div>

    <script>
        const booksData = {
            grade1: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 },
                    { name: "Ø§Ø®Ù„Ø§Ù‚ÙŠØ§Øª", price: 2000 }
                
            ],
            grade2: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 }
                
            ],
			grade3: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 }
            ],
			grade4: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
					{ name: "Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
					{ name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 },
                    { name: "Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª", price: 2000 }
            ],
			grade5: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
                    { name: "Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 },
                    { name: "Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª", price: 2000 }
            ],
			grade6: [
                    { name: "Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", price: 2000 },
                    { name: "Ù‚Ø±Ø§Ø¡Ø©", price: 3000 },
                    { name: "Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯", price: 3000 },
                    { name: "Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 1000 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ù†ÙƒÙ„ÙŠØ²ÙŠ", price: 500 },
                    { name: "Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 6000 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", price: 2000 },
                    { name: "Ø¹Ù„ÙˆÙ…", price: 6500 },
                    { name: "Ù†Ø´Ø§Ø· Ø§Ù„Ø¹Ù„ÙˆÙ…", price: 2500 },
                    { name: "Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª", price: 2000 }
            ],
			
        };

        let selectedBooks = {};

        function loadBooks() {
            const grade = document.getElementById('gradeSelect').value;
            const tbody = document.getElementById('booksContainer');
            tbody.innerHTML = '';

            booksData[grade]?.forEach((book, index) => {
                const row = document.createElement('tr');
                row.className = 'book-item';
                row.innerHTML = `
                    <td><input type="checkbox" onchange="updateSelection('${book.name}', ${book.price}, this.checked)"></td>
                    <td>${book.name}</td>
                    <td>${book.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateSelection(name, price, isChecked) {
            if(isChecked) {
                selectedBooks[name] = price;
            } else {
                delete selectedBooks[name];
            }
            updateTotals();
        }

        function updateTotals() {
            const total = Object.values(selectedBooks).reduce((a, b) => a + b, 0);
            const discount = parseInt(document.getElementById('discount').value) || 0;
            const remaining = total - discount;
            
            document.getElementById('total').value = total.toLocaleString() + ' Ø¯ÙŠÙ†Ø§Ø±';
            document.getElementById('finalAmount').value = remaining.toLocaleString() + ' Ø¯ÙŠÙ†Ø§Ø±';
            
            updateSelectedList();
        }

        function updateSelectedList() {
            const selectedList = document.getElementById('selectedList');
            selectedList.innerHTML = Object.entries(selectedBooks)
                .map(([name, price]) => `
                    <div class="selected-item">
                        <span>${name}</span>
                        <span>${price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</span>
                    </div>
                `).join('');
        }

        document.getElementById('discount').addEventListener('input', updateTotals);

        document.getElementById('saveButton').addEventListener('click', () => {
            const customerName = document.getElementById('customerName').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const total = Object.values(selectedBooks).reduce((a, b) => a + b, 0);
            const discount = parseInt(document.getElementById('discount').value) || 0;
            const remaining = total - discount;

            const printDiv = document.createElement('div');
            printDiv.style.cssText = `
                position: fixed;
                left: -9999px;
                width: 800px;
                background: white;
                padding: 40px;
                border-radius: 20px;
                font-family: 'Tajawal', sans-serif;
            `;

            printDiv.innerHTML = `
                <div class="invoice-style">
                    <div class="invoice-header">
                        <h1>Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµØ§Ø¯Ù‚</h1>
                        <p>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§Ù„Ù†Ù‡Ø±ÙˆØ§Ù† - Ø´Ø§Ø±Ø¹ 60- Ù…Ù‚Ø§Ø¨Ù„ Ù…ÙƒØªØ¨ Ø±ÙŠØ§Ø¶ ØºØ§Ù„ÙŠ</p>
                        <div class="invoice-divider"></div>
                        <h2 style="color: var(--secondary-color);">
                            <i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†: ${customerName}
                        </h2>
                    </div>

                    <div class="invoice-books">
                        <h3 style="color: var(--primary-color); margin-bottom:20px;">
                            <i class="fas fa-book"></i> Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:
                        </h3>
                        ${Object.entries(selectedBooks).map(([name, price]) => `
                            <div class="invoice-row">
                                <span>${name}</span>
                                <span style="color: var(--secondary-color);">
                                    ${price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
                                </span>
                            </div>
                        `).join('')}
                    </div>

                    <div style="margin: 35px 0;">
                        <div class="invoice-row invoice-total">
                            <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ:</span>
                            <span>${total.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</span>
                        </div>
                        <div class="invoice-row">
                            <span>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…:</span>
                            <span style="color: var(--accent-color);">
                                ${discount.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
                            </span>
                        </div>
                        <div class="invoice-row invoice-total">
                            <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</span>
                            <span style="color: var(--primary-color);">
                                ${remaining.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±
                            </span>
                        </div>
                    </div>

                    <div class="invoice-footer">
                        <i class="fas fa-heart"></i> Ø´ÙƒØ±Ù‹Ø§ Ù„Ø«Ù‚ØªÙƒÙ… Ø¨Ù†Ø§ - Ù†ØªÙ…Ù†Ù‰ Ù„ÙƒÙ… Ù‚Ø±Ø§Ø¡Ø© Ù…Ù…ØªØ¹Ø©
                    </div>
                </div>
            `;

 function loadBooks() {
            const grade = document.getElementById('gradeSelect').value;
            const container = document.getElementById('booksContainer');
            container.innerHTML = '';

            booksData[grade]?.forEach((book, index) => {
                const card = document.createElement('div');
                card.className = 'book-card';
                card.innerHTML = `
                    <input type="checkbox" 
                           id="book${index}" 
                           onchange="updateSelection('${book.name}', ${book.price}, this.checked)">
                    <label for="book${index}">${book.name}</label>
                    <div>${book.price.toLocaleString()} Ø¯ÙŠÙ†Ø§Ø±</div>
                `;
                container.appendChild(card);
            });
        }
		
            document.body.appendChild(printDiv);

            html2canvas(printDiv).then(canvas => {
                const link = document.createElement('a');
                link.download = `ÙØ§ØªÙˆØ±Ø©_${customerName}_${Date.now()}.png`;
                link.href = canvas.toDataURL();
                link.click();
                document.body.removeChild(printDiv);
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('gradeSelect').value = '';
                document.getElementById('booksContainer').innerHTML = '';
                selectedBooks = {};
                document.getElementById('customerName').value = '';
                document.getElementById('discount').value = '0';
                updateTotals();
            }).catch(error => {
                console.error('Error generating invoice:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
            });
        });
    </script>
</body>
</html>
